import{t as Y,u as Z,N as w,ad as ee,O as te,_ as ae}from"./index.9a438347.js";/* empty css              *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as oe,r as $,o as ne,bT as se,bI as le,C as c,D as b,aI as a,aH as t,G as _,u as m,aK as F,aM as s,aN as i,aJ as E,aE as k,b7 as L,bh as ie,bU as re,bV as ue,bK as de,bO as ce,bm as pe,bn as me}from"./arco.b087a425.js";import{g as _e}from"./vue.23fb8a9a.js";import{R as fe,L as he,a as ge,D as we,T as be,U as ke}from"./index.9e93fbb9.js";import{s as ve,P as ye}from"./dep-71c4f289.9bb1f385.js";import{L as Fe}from"./index.8ea44800.js";import{I as xe}from"./index.277d5d29.js";import{F as Ae,a as Ce}from"./index.a21c2bbc.js";import"./chart.836a9fe2.js";import"./slot.e07d50e4.js";import"./index.86d65e25.js";import"./form-model.535204aa.js";import"./index.2e928c7c.js";const $e=v=>(pe("data-v-cdc2decd"),v=v(),me(),v),Ee={class:"container"},Le={style:{"margin-right":"20px"}},Ie={style:{color:"#373737",margin:"10px"}},Ue={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Be={style:{display:"flex",width:"100%"}},De={style:{width:"90%"}},Ve=$e(()=>_("br",null,null,-1)),Se={style:{width:"40%",margin:"auto","text-align":"center"}},Pe={name:"Backup"},Re=oe({...Pe,setup(v){Y();const p=Z(),I=_e(),l=$({binaryFile:void 0,loading:!1,showPanel:!1,showUpload:!1,refLoading:!1,myList:[],total:0,page:1,nowpage:[]}),r=$({title:"",desc:"",firmware:[]});ne(async()=>{A({current:1})});const A=async o=>{l.page=o.current;const n=await w.get("https://k5ws.vicicode.cn/api/channel/index?server=1&limit=12&page="+o.current+"&t="+Date.now());l.total=n.data.total,l.nowpage=n.data.list},h=async()=>{l.refLoading=!0,l.showPanel=!0;const o=await w.post("https://k5ws.vicicode.cn/api/channel/my?server=1",{},{headers:{"ba-user-token":p.accountId}});l.myList=o.data,l.refLoading=!1},U=()=>{r.title="",r.desc="",r.firmware=[],l.showUpload=!0},B=async()=>{if(r.title==""||r.firmware.code==0){L.error({content:"\u672A\u586B\u5199\u540D\u79F0\u53CA\u4E0A\u4F20\u6587\u4EF6",duration:5*1e3});return}await w.post("https://k5ws.vicicode.cn/api/channel/add?server=1",{title:r.title,desc:r.desc,data:r.firmware[0].response.data.file.url},{headers:{"ba-user-token":p.accountId}}),l.showUpload=!1,h()},D=async o=>{await w.post("https://k5ws.vicicode.cn/api/channel/del?server=1",{id:o},{headers:{"ba-user-token":p.accountId}}),h()},V=async o=>{l.nowpage.filter(n=>{n.id==o&&(n.star+=1)}),await w.post("https://k5ws.vicicode.cn/api/channel/star?server=1",{id:o}),L.success({content:"\u70B9\u8D5E\u6210\u529F",duration:5*1e3})},S=()=>{h()},P=o=>{I.push({path:"/chirp/channel",query:{url:o}})},R=(o,n)=>{fetch(o).then(g=>g.blob()).then(g=>{const d=URL.createObjectURL(g),u=document.createElement("a");u.href=d,u.download=n+".xlsx",document.body.appendChild(u),u.click(),document.body.removeChild(u)})};return(o,n)=>{const g=ee,d=ie,u=ve,N=re,T=ue,z=se,M=ye,j=le,O=de,K=ce,x=te,q=Fe,G=he,H=ge,C=we,J=xe,y=Ae,Q=be,W=ke,X=Ce;return c(),b("div",Ee,[a(g,{items:[o.$t("menu.workshop"),o.$t("menu.channel")]},null,8,["items"]),a(K,{gutter:20,align:"stretch"},{default:t(()=>[a(O,{span:24},{default:t(()=>[a(j,{class:"general-card",title:o.$t("menu.channel")},{extra:t(()=>[_("div",Le,[m(p).name?(c(),b(F,{key:0},[a(d,{onClick:h},{default:t(()=>[s("\xA0\xA0"+i(m(p).name)+"\xA0\xA0",1)]),_:1}),a(d,{onClick:h},{default:t(()=>[s("\xA0\xA0"+i(o.$t("global.upload"))+"\xA0\xA0",1)]),_:1}),a(d,{onClick:n[0]||(n[0]=e=>m(p).logout())},{default:t(()=>[s("\xA0\xA0"+i(o.$t("global.logout"))+"\xA0\xA0",1)]),_:1})],64)):(c(),b(F,{key:1},[a(d,{onClick:n[1]||(n[1]=e=>m(p).setInfo({showLogin:!0}))},{default:t(()=>[s("\xA0\xA0"+i(o.$t("global.login"))+"\xA0\xA0",1)]),_:1}),a(d,{onClick:n[2]||(n[2]=e=>m(p).setInfo({showRegister:!0}))},{default:t(()=>[s("\xA0\xA0"+i(o.$t("global.register"))+"\xA0\xA0",1)]),_:1}),_("span",Ie,i(o.$t("global.loginUpload")),1)],64))])]),default:t(()=>[a(z,null,{default:t(()=>[(c(!0),b(F,null,E(l.nowpage,e=>(c(),k(T,{style:{width:"100%"}},{actions:t(()=>[a(u,{style:{"margin-left":"1rem"}},{default:t(()=>[s(i(e.create_time_text),1)]),_:2},1024),a(d,{onClick:f=>V(e.id)},{default:t(()=>[s("\u{1F44D}\uFF08"+i(e.star)+"\uFF09",1)]),_:2},1032,["onClick"]),a(d,{onClick:f=>R("https://k5ws.vicicode.cn"+e.file,e.title)},{default:t(()=>[s(i(o.$t("global.download")),1)]),_:2},1032,["onClick"]),a(d,{onClick:f=>P("https://k5ws.vicicode.cn"+e.file)},{default:t(()=>[s(i(o.$t("global.use")),1)]),_:2},1032,["onClick"])]),default:t(()=>[a(N,{description:e.desc},{title:t(()=>[a(u,{theme:"primary",variant:"outline"},{default:t(()=>{var f;return[s(i((f=e.user)==null?void 0:f.nickname),1)]}),_:2},1024),s(" "+i(e.title),1)]),_:2},1032,["description"])]),_:2},1024))),256))]),_:1}),a(M,{onChange:A,style:{margin:"10px"},total:l.total,current:l.page,pageSize:12,showPageNumber:"",showPageSize:!1},null,8,["total","current"])]),_:1},8,["title"])]),_:1})]),_:1}),a(C,{visible:l.showPanel,"onUpdate:visible":n[3]||(n[3]=e=>l.showPanel=e),size:"50%",header:"\u6211\u7684\u5206\u4EAB",footer:!1},{default:t(()=>[_("div",Ue,[a(x,{style:{margin:"10px"},onClick:U},{default:t(()=>[s("\u4E0A\u4F20\u65B0\u5206\u4EAB")]),_:1}),a(x,{loading:l.refLoading,shape:"circle",theme:"outline",onClick:S},{icon:t(()=>[a(m(fe))]),_:1},8,["loading"])]),a(H,{split:!0},{default:t(()=>[(c(!0),b(F,null,E(l.myList,e=>(c(),k(G,null,{default:t(()=>[_("div",Be,[_("div",De,[e.status==0?(c(),k(u,{key:0,theme:"primary",variant:"outline"},{default:t(()=>[s("\u5BA1\u6838\u4E2D"+i(e.remark&&`\uFF08${e.remark}\uFF09`),1)]),_:2},1024)):e.status==1?(c(),k(u,{key:1,theme:"primary",variant:"outline"},{default:t(()=>[s("\u5DF2\u5BA1\u6838"+i(e.remark&&`\uFF08${e.remark}\uFF09`),1)]),_:2},1024)):(c(),k(u,{key:2,theme:"primary",variant:"outline"},{default:t(()=>[s("\u5DF2\u9A73\u56DE"+i(e.remark&&`\uFF08${e.remark}\uFF09`),1)]),_:2},1024)),s(" "+i(e.title)+" ",1),Ve,s(" "+i(e.desc),1)]),_("div",Se,[a(u,null,{default:t(()=>[s(i(e.create_time_text),1)]),_:2},1024),s("\xA0 "),a(q,{theme:"primary",hover:"color",onClick:f=>D(e.id)},{default:t(()=>[s("\u5220\u9664")]),_:2},1032,["onClick"])])])]),_:2},1024))),256))]),_:1})]),_:1},8,["visible"]),a(C,{visible:l.showUpload,"onUpdate:visible":n[7]||(n[7]=e=>l.showUpload=e),size:"25%",header:"\u4E0A\u4F20\u65B0\u56FA\u4EF6",footer:!1},{default:t(()=>[a(X,{data:r,"reset-type":"initial",colon:"",onSubmit:B},{default:t(()=>[a(y,{label:"\u5206\u4EAB\u540D\u79F0",name:"title","label-align":"top"},{default:t(()=>[a(J,{modelValue:r.title,"onUpdate:modelValue":n[4]||(n[4]=e=>r.title=e)},null,8,["modelValue"])]),_:1}),a(y,{label:"\u5206\u4EAB\u63CF\u8FF0",name:"desc","label-align":"top"},{default:t(()=>[a(Q,{maxlength:200,autosize:{minRows:5,maxRows:10},modelValue:r.desc,"onUpdate:modelValue":n[5]||(n[5]=e=>r.desc=e),clearable:""},null,8,["modelValue"])]),_:1}),a(y,{label:"\u4FE1\u9053\u6587\u4EF6",name:"firmware","label-align":"top"},{default:t(()=>[a(W,{modelValue:r.firmware,"onUpdate:modelValue":n[6]||(n[6]=e=>r.firmware=e),action:"https://k5ws.vicicode.cn/api/ajax/upload?server=1","abridge-name":[8,6],headers:{"ba-user-token":m(p).accountId},theme:"file-input",placeholder:"\u672A\u9009\u62E9\u6587\u4EF6"},null,8,["modelValue","headers"])]),_:1}),a(y,{"label-align":"top"},{default:t(()=>[a(x,{theme:"primary",type:"submit",block:""},{default:t(()=>[s("\u63D0\u4EA4\u5BA1\u6838")]),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["visible"])])}}});const st=ae(Re,[["__scopeId","data-v-cdc2decd"]]);export{st as default};
